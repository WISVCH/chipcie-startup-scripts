version: '3.4'
services:
    domserver:
        build:
            context: ./domserver
            target: domserver
        ports:
            - "8080:80"
        env_file:
            - domserver.env
    eventdaemon:
        build:
            context: ./domserver
            target: eventdaemon
        env_file:
            - eventdaemon.env
            - domserver.env
    db:
        image: mariadb
        volumes:
            - ./db:/etc/mysql/conf.d
            - /var/lib/containers/domjudge_db:/var/lib/mysql
        env_file:
            - domserver.env
